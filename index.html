<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weather App — Enhanced Visuals</title>

  <!-- Google font & FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    /* ========== Theme variables ========== */
    :root{
      --bg-0: #020204;           /* deep black */
      --bg-1: #07071a;           /* near-black gradient color */
      --frost: rgba(255,255,255,0.08);
      --panel-border: rgba(255,255,255,0.12);
      --accent: #00c6ff;         /* cyan accent */
      --accent-2: #6ae0ff;       /* secondary accent */
      --neon: rgba(0,198,255,0.18);
      --text-weak: rgba(255,255,255,0.85);
      --glass: rgba(255,255,255,0.06);
      --glass-strong: rgba(255,255,255,0.12);
    }

    /* Light theme overrides (applied with .light-theme on <body>) */
    body.light-theme {
      --bg-0: #0b1220;
      --bg-1: #0f1724;
      --frost: rgba(6,6,15,0.06);
      --panel-border: rgba(0,0,0,0.08);
      --accent: #0072ff;
      --accent-2: #4fb3ff;
      --neon: rgba(0,114,255,0.10);
      --text-weak: rgba(255,255,255,0.95);
      --glass: rgba(255,255,255,0.06);
      --glass-strong: rgba(255,255,255,0.10);
    }

    /* Global reset */
    *{box-sizing:border-box;margin:0;padding:0;font-family:"Poppins",sans-serif}
    html,body{height:100%}

    /* ===== Background & canvas layers ===== */
    body{
      background: radial-gradient(circle at 10% 30%, rgba(10,20,40,0.35), transparent 5%),
                  radial-gradient(circle at 80% 70%, rgba(0,80,120,0.06), transparent 6%),
                  linear-gradient(180deg, var(--bg-0) 0%, var(--bg-1) 100%);
      overflow:hidden;
      color:var(--text-weak);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Canvas layers */
    canvas#stars, canvas#particles {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      pointer-events: none; /* don't block UI */
    }
    canvas#stars { z-index: -20; opacity: 1; }
    canvas#particles { z-index: -5; opacity: 0.95; }

    /* Earth below UI but above stars */
    .earth-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%,-50%);
      z-index: -10;
      opacity: 0.9;
      filter: drop-shadow(0 30px 60px rgba(0,0,0,0.6));
    }
    .earth {
      width: 840px;
      height: 840px;
      background: url("https://raw.githubusercontent.com/itsksaurabh/rotating-earth/master/earthmap.jpg") center/cover no-repeat;
      border-radius:50%;
      animation: rotateEarth 40s linear infinite;
      box-shadow: 0 0 80px rgba(0,120,255,0.06), inset 0 0 40px rgba(0,0,0,0.35);
      transform-origin: center;
    }
    @keyframes rotateEarth { 0%{background-position:0 0} 100%{background-position:-2000px 0} }

    /* Main layout */
    .main {
      position: relative;
      z-index: 20;
      min-height: 100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px 20px;
      gap:20px;
      flex-direction:column;
    }

    /* Panels */
    .box, .box-main {
      width: 420px;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      backdrop-filter: blur(14px) saturate(120%);
      border: 1px solid var(--panel-border);
      padding: 28px;
      color:var(--text-weak);
      text-align:center;
      box-shadow:
        0 6px 30px rgba(0,0,0,0.6),
        0 0 30px var(--neon);
      transition: transform 220ms ease, box-shadow 220ms ease;
    }

    .box:hover, .box-main:hover { transform: translateY(-6px) }

    /* Input row + theme toggle */
    .inp {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }

    .inp input {
      width: 100%;
      padding:12px 16px;
      border-radius: 22px;
      border: none;
      outline: none;
      font-size: 16px;
      background: var(--glass);
      color: var(--text-weak);
      box-shadow: 0 6px 18px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.02);
    }

    .inp button {
      width:48px;
      height:48px;
      border-radius:50%;
      border:none;
      cursor:pointer;
      display:inline-grid;
      place-items:center;
      font-size:18px;
      background: linear-gradient(180deg,var(--accent),var(--accent-2));
      color:#001219;
      box-shadow: 0 6px 18px rgba(0,0,0,0.5), 0 0 18px rgba(0,198,255,0.14);
      transition: transform 160ms ease, filter 160ms;
    }
    .inp button:active { transform: scale(0.96) }

    /* Theme toggle placed top-right inside first box */
    .top-row { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px }
    .theme-toggle {
      display:inline-flex;
      align-items:center;
      gap:8px;
      background: rgba(255,255,255,0.02);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.03);
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      cursor:pointer;
    }
    .theme-toggle i { font-size:14px; color:var(--accent-2) }

    /* Weather UI */
    #country { font-size:42px; font-weight:700; letter-spacing:0.4px }
    .weather { width:110px; height:110px; object-fit:contain; margin:8px auto }
    #temp { font-size:52px; font-weight:700; margin-top:6px }
    #des { font-size:15px; opacity:0.9; text-transform:capitalize; margin-top:6px }

    .two { display:flex; justify-content:space-between; margin-top:20px; gap:12px }
    .inner { width:48%; text-align:center }
    .item { display:flex; align-items:center; justify-content:center; gap:12px }

    .metric-icon { width:34px; height:34px; opacity:0.95 }

    #err { color:#ff5c6c; display:none; margin-top:12px; font-weight:600 }

    /* Neon accent outlines for important UI */
    .accent-outline {
      box-shadow:
        0 6px 24px rgba(0,0,0,0.6),
        0 0 24px rgba(0,198,255,0.08),
        inset 0 1px 0 rgba(255,255,255,0.02);
      border: 1px solid rgba(0,198,255,0.12);
    }

    /* Small responsive */
    @media (max-width:480px){
      .box,.box-main{width:92%; padding:18px}
      .earth { width:520px; height:520px }
      #country{font-size:30px}
      #temp{font-size:36px}
    }
  </style>
</head>
<body>

  <!-- Canvas layers -->
  <canvas id="stars"></canvas>
  <canvas id="particles"></canvas>

  <!-- Rotating Earth image -->
  <div class="earth-container" aria-hidden="true">
    <div class="earth" role="presentation"></div>
  </div>

  <div class="main">

    <!-- Controls panel -->
    <div class="box accent-outline" style="max-width:460px;">
      <div class="top-row">
        <div style="font-weight:700">Weather — Search</div>
        <div class="theme-toggle" id="themeToggle" title="Toggle theme">
          <i class="fa-solid fa-sun"></i>
          <span style="opacity:0.85;font-size:14px">Theme</span>
        </div>
      </div>

      <div class="inp" style="margin-top:6px">
        <input type="text" id="cityInput" placeholder="Enter city name (e.g., London)" aria-label="City">
        <button id="searchBtn" aria-label="Search"><i class="fa-solid fa-magnifying-glass"></i></button>
      </div>

      <p id="err">City name is invalid</p>
    </div>

    <!-- Display panel -->
    <div class="box-main accent-outline" style="display:none;">
      <h1 id="country">—</h1>
      <img src="clouds.png" alt="weather icon" class="weather">
      <h1 id="temp">—°C</h1>
      <p id="des">—</p>

      <div class="two">
        <div class="inner">
          <div class="item">
            <img src="humidity.png" class="metric-icon" alt="">
            <h1 id="humidity">—%</h1>
          </div>
          <p style="opacity:0.85;margin-top:6px">Humidity</p>
        </div>

        <div class="inner">
          <div class="item">
            <img src="wind.png" class="metric-icon" alt="">
            <h1 id="wind">— km/h</h1>
          </div>
          <p style="opacity:0.85;margin-top:6px">Wind Speed</p>
        </div>
      </div>
    </div>
  </div>

  <script>
  /* =========================
     Theme toggle + persistence
     ========================= */
  (function(){
    const body = document.body;
    const toggle = document.getElementById('themeToggle');
    const icon = toggle.querySelector('i');

    // initialize from localStorage or prefers-color-scheme
    const stored = localStorage.getItem('weather_theme');
    if(stored === 'light') body.classList.add('light-theme');
    else if (!stored) {
      if(window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches){
        body.classList.add('light-theme');
      }
    }
    // set icon
    function updateIcon(){
      if(body.classList.contains('light-theme')){
        icon.className = 'fa-solid fa-sun';
      } else {
        icon.className = 'fa-solid fa-moon';
      }
    }
    updateIcon();

    toggle.addEventListener('click', ()=>{
      body.classList.toggle('light-theme');
      if(body.classList.contains('light-theme')) localStorage.setItem('weather_theme','light');
      else localStorage.setItem('weather_theme','dark');
      updateIcon();
    });
  })();

  /* =========================
     Starfield (background) — performant canvas
     ========================= */
  (function(){
    const canvas = document.getElementById('stars');
    const ctx = canvas.getContext('2d');
    let w=canvas.width=innerWidth, h=canvas.height=innerHeight, dpi=window.devicePixelRatio||1;
    canvas.width = innerWidth * dpi; canvas.height = innerHeight * dpi; canvas.style.width = innerWidth + 'px'; canvas.style.height = innerHeight + 'px'; ctx.scale(dpi,dpi);

    const num = Math.floor((w*h)/50000) + 80; // star density scales with screen
    const stars = [];

    for(let i=0;i<num;i++){
      stars.push({
        x: Math.random()*w,
        y: Math.random()*h,
        r: Math.random()*1.6 + 0.2,
        alpha: Math.random()*0.8 + 0.2,
        twink: Math.random()*0.02 + 0.003,
        phase: Math.random()*Math.PI*2
      });
    }

    function drawStars(t){
      ctx.clearRect(0,0,w,h);
      // subtle gradient for depth
      const g = ctx.createLinearGradient(0,0,0,h);
      g.addColorStop(0, 'rgba(255,255,255,0.03)');
      g.addColorStop(1, 'rgba(0,0,0,0.0)');
      ctx.fillStyle = g;
      ctx.fillRect(0,0,w,h);

      for(const s of stars){
        const a = s.alpha + Math.sin((t*0.001+s.phase))*s.twink;
        ctx.beginPath();
        ctx.fillStyle = `rgba(255,255,255,${Math.max(0,Math.min(1,a))})`;
        ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
        ctx.fill();
      }
    }

    let then = 0;
    function loop(now){
      if(!then) then = now;
      const dt = now-then;
      drawStars(now);
      then = now;
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);

    // responsiveness
    window.addEventListener('resize', ()=>{
      w = canvas.width = innerWidth * (window.devicePixelRatio||1);
      h = canvas.height = innerHeight * (window.devicePixelRatio||1);
      canvas.style.width = innerWidth + 'px'; canvas.style.height = innerHeight + 'px';
      ctx.setTransform(window.devicePixelRatio||1,0,0,window.devicePixelRatio||1,0,0);
    });
  })();

  /* =========================
     Floating particles (subtle, foreground)
     ========================= */
  (function(){
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    let w = canvas.width = innerWidth;
    let h = canvas.height = innerHeight;
    canvas.width = innerWidth * (devicePixelRatio||1); canvas.height = innerHeight * (devicePixelRatio||1);
    canvas.style.width = innerWidth + 'px'; canvas.style.height = innerHeight + 'px';
    ctx.scale(devicePixelRatio||1, devicePixelRatio||1);

    const particles = [];
    const maxParticles = Math.floor((w*h)/150000) + 40;

    function spawnParticle(){
      const size = Math.random()*3 + 1;
      particles.push({
        x: Math.random()*w,
        y: Math.random()*h,
        vx: (Math.random()-0.5) * 0.25,
        vy: - (0.2 + Math.random()*0.6),
        r: size,
        alpha: 0.06 + Math.random()*0.16,
        life: 200 + Math.random()*400
      });
    }

    // initial
    for(let i=0;i<maxParticles;i++) spawnParticle();

    function updateAndDraw(){
      ctx.clearRect(0,0,innerWidth,innerHeight);

      for(let i = particles.length-1; i>=0; i--){
        const p = particles[i];
        p.x += p.vx;
        p.y += p.vy;
        p.life--;
        // soft glow
        const grd = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r*4);
        grd.addColorStop(0, `rgba(0,198,255,${p.alpha*0.9})`);
        grd.addColorStop(1, `rgba(0,198,255,0)`);
        ctx.fillStyle = grd;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r*4, 0, Math.PI*2);
        ctx.fill();

        if(p.life <= 0 || p.y < -50 || p.x < -50 || p.x > innerWidth + 50){
          particles.splice(i,1);
        }
      }

      // maintain population
      while(particles.length < maxParticles) spawnParticle();

      requestAnimationFrame(updateAndDraw);
    }

    updateAndDraw();

    // responsive
    window.addEventListener('resize', ()=>{
      const dpi = devicePixelRatio||1;
      canvas.width = innerWidth * dpi; canvas.height = innerHeight * dpi;
      canvas.style.width = innerWidth + 'px'; canvas.style.height = innerHeight + 'px';
      ctx.setTransform(dpi,0,0,dpi,0,0);
      w = innerWidth; h = innerHeight;
    });
  })();

  /* =========================
     Weather fetch logic (fixed + integrated)
     ========================= */
  (function(){
    const apiid = "32edaaa4139cd337f606e36b54e01cd5"; // your key
    const searchBtn = document.getElementById('searchBtn');
    const input = document.getElementById('cityInput');
    const err = document.getElementById('err');
    const boxMain = document.querySelector('.box-main');

    async function checkweather(name){
      if(!name) return;
      try{
        const apiurl = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(name)}&units=metric&appid=${apiid}`;
        const res = await fetch(apiurl);
        const data = await res.json();

        if(!data || data.cod && data.cod != 200){
          boxMain.style.display = 'none';
          err.style.display = 'block';
          err.textContent = 'City name is invalid or not found';
          return;
        }

        err.style.display = 'none';
        boxMain.style.display = 'block';

        const img = document.querySelector('.weather');
        const condition = (data.weather && data.weather[0] && data.weather[0].main) || '';
        // map conditions to images: ensure these files exist in same folder or use remote PNGs
        const map = {
          Clouds: 'clouds.png',
          Clear: 'clear.png',
          Rain: 'rain.png',
          Drizzle: 'rain.png',
          Mist: 'mist.png',
          Smoke: 'mist.png',
          Haze: 'mist.png',
          Snow: 'snow.png',
          Thunderstorm: 'rain.png'
        };
        img.src = map[condition] || 'clouds.png';

        document.getElementById('country').textContent = data.name + (data.sys && data.sys.country ? ', '+data.sys.country : '');
        document.getElementById('temp').textContent = Math.round(data.main.temp) + '°C';
        document.getElementById('des').textContent = (data.weather[0].description || '').replace(/\b\w/g, c=>c.toUpperCase());
        document.getElementById('humidity').textContent = data.main.humidity + '%';
        document.getElementById('wind').textContent = (data.wind.speed || 0) + ' km/h';
      } catch(e){
        console.error(e);
        boxMain.style.display = 'none';
        err.style.display = 'block';
        err.textContent = 'Network error — please try again';
      }
    }

    searchBtn.addEventListener('click', ()=>{
      const q = input.value.trim();
      if(q) checkweather(q);
    });

    // support Enter key
    input.addEventListener('keydown', (ev)=>{
      if(ev.key === 'Enter') searchBtn.click();
    });
  })();

  </script>
</body>
</html>
 